Supercombinator definitions
Code for I:
   {Take 1,
    Enter Arg 1}


Code for K:
   {Take 2,
    Enter Arg 1}


Code for K1:
   {Take 2,
    Enter Arg 2}


Code for S:
   {Take 3,
    Push Code {Push Arg 3,
               Enter Arg 2},
    Push Arg 3,
    Enter Arg 1}


Code for compose:
   {Take 3,
    Push Code {Push Arg 3,
               Enter Arg 2},
    Enter Arg 1}


Code for twice:
   {Take 1,
    Push Arg 1,
    Push Arg 1,
    Enter Label "compose"}


Code for id:
   {Take 0,
    Push Label "K",
    Push Label "K",
    Enter Label "S"}


Code for id1:
   {Take 0,
    Push Label "id",
    Enter Label "id"}


Code for main:
   {Take 0,
    Push IntConst 4,
    Enter Label "id1"}



State transitions

   0) Code:  {Enter Label "main"}
      Null frame ptr
      Arg stack: []
      
      
   1) Code:  {Take 0, Push IntConst 4, Enter Label "id1"}
      Null frame ptr
      Arg stack: []
      
      
   2) Code:  {Push IntConst 4, Enter Label "id1"}
      Frame: <>
      Arg stack: []
      
      
   3) Code:  {Enter Label "id1"}
      Frame: <>
      Arg stack: [({},FrameInt 4)]
      
      
   4) Code:  {Take 0, Push Label "id", Enter Label "id"}
      Frame: <>
      Arg stack: [({},FrameInt 4)]
      
      
   5) Code:  {Push Label "id", Enter Label "id"}
      Frame: <>
      Arg stack: [({},FrameInt 4)]
      
      
   6) Code:  {Enter Label "id"}
      Frame: <>
      Arg stack: [({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)
                  ({},FrameInt 4)]
      
      
   7) Code:  {Take 0, Push Label "K", Push Label "K", ..}
      Frame: <>
      Arg stack: [({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)
                  ({},FrameInt 4)]
      
      
   8) Code:  {Push Label "K", Push Label "K", Enter Label "S"}
      Frame: <>
      Arg stack: [({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)
                  ({},FrameInt 4)]
      
      
   9) Code:  {Push Label "K", Enter Label "S"}
      Frame: <>
      Arg stack: [({Take 2, Enter Arg 1},FrameAddr 3)
                  ({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)
                  ({},FrameInt 4)]
      
      
  10) Code:  {Enter Label "S"}
      Frame: <>
      Arg stack: [({Take 2, Enter Arg 1},FrameAddr 3)
                  ({Take 2, Enter Arg 1},FrameAddr 3)
                  ({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)
                  ({},FrameInt 4)]
      
      
  11) Code:  {Take 3, Push Code {..}, Push Arg 3, ..}
      Frame: <>
      Arg stack: [({Take 2, Enter Arg 1},FrameAddr 3)
                  ({Take 2, Enter Arg 1},FrameAddr 3)
                  ({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)
                  ({},FrameInt 4)]
      
      
  12) Code:  {Push Code {..}, Push Arg 3, Enter Arg 1}
      Frame: <({Take 2, Enter Arg 1},FrameAddr 3)
              ({Take 2, Enter Arg 1},FrameAddr 3)
              ({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)>
      Arg stack: [({},FrameInt 4)]
      
      
  13) Code:  {Push Arg 3, Enter Arg 1}
      Frame: <({Take 2, Enter Arg 1},FrameAddr 3)
              ({Take 2, Enter Arg 1},FrameAddr 3)
              ({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)>
      Arg stack: [({Push Arg 3, Enter Arg 2},FrameAddr 4)
                  ({},FrameInt 4)]
      
      
  14) Code:  {Enter Arg 1}
      Frame: <({Take 2, Enter Arg 1},FrameAddr 3)
              ({Take 2, Enter Arg 1},FrameAddr 3)
              ({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)>
      Arg stack: [({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)
                  ({Push Arg 3, Enter Arg 2},FrameAddr 4)
                  ({},FrameInt 4)]
      
      
  15) Code:  {Take 2, Enter Arg 1}
      Frame: <>
      Arg stack: [({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)
                  ({Push Arg 3, Enter Arg 2},FrameAddr 4)
                  ({},FrameInt 4)]
      
      
  16) Code:  {Enter Arg 1}
      Frame: <({Take 0, Push Label "K", Push Label "K", ..},FrameAddr 2)
              ({Push Arg 3, Enter Arg 2},FrameAddr 4)>
      Arg stack: [({},FrameInt 4)]
      
      
  17) Code:  {Take 0, Push Label "K", Push Label "K", ..}
      Frame: <>
      Arg stack: [({},FrameInt 4)]
      
      
  18) Code:  {Push Label "K", Push Label "K", Enter Label "S"}
      Frame: <>
      Arg stack: [({},FrameInt 4)]
      
      
  19) Code:  {Push Label "K", Enter Label "S"}
      Frame: <>
      Arg stack: [({Take 2, Enter Arg 1},FrameAddr 6)
                  ({},FrameInt 4)]
      
      
  20) Code:  {Enter Label "S"}
      Frame: <>
      Arg stack: [({Take 2, Enter Arg 1},FrameAddr 6)
                  ({Take 2, Enter Arg 1},FrameAddr 6)
                  ({},FrameInt 4)]
      
      
  21) Code:  {Take 3, Push Code {..}, Push Arg 3, ..}
      Frame: <>
      Arg stack: [({Take 2, Enter Arg 1},FrameAddr 6)
                  ({Take 2, Enter Arg 1},FrameAddr 6)
                  ({},FrameInt 4)]
      
      
  22) Code:  {Push Code {..}, Push Arg 3, Enter Arg 1}
      Frame: <({Take 2, Enter Arg 1},FrameAddr 6)
              ({Take 2, Enter Arg 1},FrameAddr 6)
              ({},FrameInt 4)>
      Arg stack: []
      
      
  23) Code:  {Push Arg 3, Enter Arg 1}
      Frame: <({Take 2, Enter Arg 1},FrameAddr 6)
              ({Take 2, Enter Arg 1},FrameAddr 6)
              ({},FrameInt 4)>
      Arg stack: [({Push Arg 3, Enter Arg 2},FrameAddr 7)]
      
      
  24) Code:  {Enter Arg 1}
      Frame: <({Take 2, Enter Arg 1},FrameAddr 6)
              ({Take 2, Enter Arg 1},FrameAddr 6)
              ({},FrameInt 4)>
      Arg stack: [({},FrameInt 4)
                  ({Push Arg 3, Enter Arg 2},FrameAddr 7)]
      
      
  25) Code:  {Take 2, Enter Arg 1}
      Frame: <>
      Arg stack: [({},FrameInt 4)
                  ({Push Arg 3, Enter Arg 2},FrameAddr 7)]
      
      
  26) Code:  {Enter Arg 1}
      Frame: <({},FrameInt 4)
              ({Push Arg 3, Enter Arg 2},FrameAddr 7)>
      Arg stack: []
      
      
  27) Code:  {}
      Frame ptr (int): 4
      Arg stack: []
      
      


Steps taken = 27
Frames allocated =  8
