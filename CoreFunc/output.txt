Supercombinator definitions
Code for I:
   {Take (1,1),
    Enter Arg 1}


Code for K:
   {Take (2,2),
    Enter Arg 1}


Code for K1:
   {Take (2,2),
    Enter Arg 2}


Code for S:
   {Take (3,3),
    Push Code {Push Arg 3,
               Enter Arg 2},
    Push Arg 3,
    Enter Arg 1}


Code for compose:
   {Take (3,3),
    Push Code {Push Arg 3,
               Enter Arg 2},
    Enter Arg 1}


Code for twice:
   {Take (1,1),
    Push Arg 1,
    Push Arg 1,
    Enter Label "compose"}


Code for f:
   {Take (4,3),
    Move
      (4,
       Code
         [Push (Code [Push (Code [Op Add; Return]); Enter (Arg 1)]); Enter (Arg 2)]),
    Push Code {Push Code {Push Code {Push Code {Op Add,
                                                Op Add,
                                                Op Add,
                                                Return},
                                     Enter Arg 4},
                          Enter Arg 1},
               Enter Arg 2},
    Enter Arg 3}


Code for main:
   {Push IntConst 3,
    Push IntConst 2,
    Push IntConst 1,
    Enter Label "f"}



State transitions

   0) Code:  {Enter Label "main"}
      Null frame ptr
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   1) Code:  {Push IntConst 3, Push IntConst 2, Push IntConst 1, ..}
      Null frame ptr
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   2) Code:  {Push IntConst 2, Push IntConst 1, Enter Label "f"}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 3)
                  ({},FrameNull)]
      VStack:[]
      
   3) Code:  {Push IntConst 1, Enter Label "f"}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 2)
                  ({PushV FramePtr, Return},FrameInt 3)
                  ({},FrameNull)]
      VStack:[]
      
   4) Code:  {Enter Label "f"}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 1)
                  ({PushV FramePtr, Return},FrameInt 2)
                  ({PushV FramePtr, Return},FrameInt 3)
                  ({},FrameNull)]
      VStack:[]
      
   5) Code:  {Take (4,3), Move
                (4,
                 Code
                   [Push (Code [Push (Code [Op Add; Return]); Enter (Arg 1)]); Enter (Arg 2)]), Push Code {..}, ..}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 1)
                  ({PushV FramePtr, Return},FrameInt 2)
                  ({PushV FramePtr, Return},FrameInt 3)
                  ({},FrameNull)]
      VStack:[]
      
   6) Code:  {Move
                (4,
                 Code
                   [Push (Code [Push (Code [Op Add; Return]); Enter (Arg 1)]); Enter (Arg 2)]), Push Code {..}, Enter Arg 3}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 3)
              ({},FrameNull)>
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   7) Code:  {Push Code {..}, Enter Arg 3}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   8) Code:  {Enter Arg 3}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
   9) Code:  {Push Code {..}, Enter Arg 2}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
  10) Code:  {Enter Arg 2}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
  11) Code:  {PushV FramePtr, Return}
      Frame ptr (int): 2
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
  12) Code:  {Return}
      Frame ptr (int): 2
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  13) Code:  {Push Code {..}, Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  14) Code:  {Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({Op Add, Return},FrameAddr 1)
                  ({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  15) Code:  {PushV FramePtr, Return}
      Frame ptr (int): 1
      Arg stack: [({Op Add, Return},FrameAddr 1)
                  ({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  16) Code:  {Return}
      Frame ptr (int): 1
      Arg stack: [({Op Add, Return},FrameAddr 1)
                  ({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2]
      
  17) Code:  {Op Add, Return}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2]
      
  18) Code:  {Return}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[3]
      
  19) Code:  {Push Code {..}, Enter Arg 2}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({},FrameNull)]
      VStack:[3]
      
  20) Code:  {Enter Arg 2}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[3]
      
  21) Code:  {PushV FramePtr, Return}
      Frame ptr (int): 2
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[3]
      
  22) Code:  {Return}
      Frame ptr (int): 2
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 3]
      
  23) Code:  {Push Code {..}, Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({},FrameNull)]
      VStack:[2, 3]
      
  24) Code:  {Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({Push Code {..}, Enter Arg 4},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 3]
      
  25) Code:  {PushV FramePtr, Return}
      Frame ptr (int): 1
      Arg stack: [({Push Code {..}, Enter Arg 4},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 3]
      
  26) Code:  {Return}
      Frame ptr (int): 1
      Arg stack: [({Push Code {..}, Enter Arg 4},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2, 3]
      
  27) Code:  {Push Code {..}, Enter Arg 4}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({},FrameNull)]
      VStack:[1, 2, 3]
      
  28) Code:  {Enter Arg 4}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV FramePtr, Return},FrameInt 2)
              ({Push Code {..}, Enter Arg 2},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({Op Add, Op Add, Op Add, ..},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2, 3]
      
  29) Code:  {}
      Null frame ptr
      Arg stack: [({Op Add, Op Add, Op Add, ..},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2, 3]
      


Steps taken = 29
Frames allocated =  1
Total heap allocations = 3
