Supercombinator definitions
Code for I:
   {Take 1,
    Enter Arg 1}


Code for K:
   {Take 2,
    Enter Arg 1}


Code for K1:
   {Take 2,
    Enter Arg 2}


Code for S:
   {Take 3,
    Push Code {Push Arg 3,
               Enter Arg 2},
    Push Arg 3,
    Enter Arg 1}


Code for compose:
   {Take 3,
    Push Code {Push Arg 3,
               Enter Arg 2},
    Enter Arg 1}


Code for twice:
   {Take 1,
    Push Arg 1,
    Push Arg 1,
    Enter Label "compose"}


Code for four:
   {Push IntConst 2,
    Push IntConst 2,
    Enter Label "+"}


Code for main:
   {Push Label "four",
    Push Label "four",
    Enter Label "*"}


Code for +:
   {Take 2,
    Push Code {Push Code {Op Add,
                          Return},
               Enter Arg 1},
    Enter Arg 2}


Code for -:
   {Take 2,
    Push Code {Push Code {Op Sub,
                          Return},
               Enter Arg 1},
    Enter Arg 2}


Code for *:
   {Take 2,
    Push Code {Push Code {Op Mul,
                          Return},
               Enter Arg 1},
    Enter Arg 2}


Code for /:
   {Take 2,
    Push Code {Push Code {Op Div,
                          Return},
               Enter Arg 1},
    Enter Arg 2}



State transitions

   0) Code:  {Enter Label "main"}
      Null frame ptr
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   1) Code:  {Push Label "four", Push Label "four", Enter Label "*"}
      Null frame ptr
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   2) Code:  {Push Label "four", Enter Label "*"}
      Null frame ptr
      Arg stack: [({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)
                  ({},FrameNull)]
      VStack:[]
      
   3) Code:  {Enter Label "*"}
      Null frame ptr
      Arg stack: [({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)
                  ({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)
                  ({},FrameNull)]
      VStack:[]
      
   4) Code:  {Take 2, Push Code {..}, Enter Arg 2}
      Null frame ptr
      Arg stack: [({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)
                  ({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)
                  ({},FrameNull)]
      VStack:[]
      
   5) Code:  {Push Code {..}, Enter Arg 2}
      Frame: <({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)
              ({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)>
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   6) Code:  {Enter Arg 2}
      Frame: <({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)
              ({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)>
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
   7) Code:  {Push IntConst 2, Push IntConst 2, Enter Label "+"}
      Null frame ptr
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
   8) Code:  {Push IntConst 2, Enter Label "+"}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 2)
                  ({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
   9) Code:  {Enter Label "+"}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 2)
                  ({PushV FramePtr, Return},FrameInt 2)
                  ({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
  10) Code:  {Take 2, Push Code {..}, Enter Arg 2}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 2)
                  ({PushV FramePtr, Return},FrameInt 2)
                  ({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
  11) Code:  {Push Code {..}, Enter Arg 2}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
  12) Code:  {Enter Arg 2}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 2)
                  ({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
  13) Code:  {PushV FramePtr, Return}
      Frame ptr (int): 2
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 2)
                  ({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
  14) Code:  {Return}
      Frame ptr (int): 2
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 2)
                  ({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  15) Code:  {Push Code {..}, Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  16) Code:  {Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Op Add, Return},FrameAddr 2)
                  ({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  17) Code:  {PushV FramePtr, Return}
      Frame ptr (int): 2
      Arg stack: [({Op Add, Return},FrameAddr 2)
                  ({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  18) Code:  {Return}
      Frame ptr (int): 2
      Arg stack: [({Op Add, Return},FrameAddr 2)
                  ({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 2]
      
  19) Code:  {Op Add, Return}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 2]
      
  20) Code:  {Return}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[4]
      
  21) Code:  {Push Code {..}, Enter Arg 1}
      Frame: <({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)
              ({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)>
      Arg stack: [({},FrameNull)]
      VStack:[4]
      
  22) Code:  {Enter Arg 1}
      Frame: <({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)
              ({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)>
      Arg stack: [({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[4]
      
  23) Code:  {Push IntConst 2, Push IntConst 2, Enter Label "+"}
      Null frame ptr
      Arg stack: [({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[4]
      
  24) Code:  {Push IntConst 2, Enter Label "+"}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 2)
                  ({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[4]
      
  25) Code:  {Enter Label "+"}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 2)
                  ({PushV FramePtr, Return},FrameInt 2)
                  ({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[4]
      
  26) Code:  {Take 2, Push Code {..}, Enter Arg 2}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 2)
                  ({PushV FramePtr, Return},FrameInt 2)
                  ({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[4]
      
  27) Code:  {Push Code {..}, Enter Arg 2}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[4]
      
  28) Code:  {Enter Arg 2}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 3)
                  ({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[4]
      
  29) Code:  {PushV FramePtr, Return}
      Frame ptr (int): 2
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 3)
                  ({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[4]
      
  30) Code:  {Return}
      Frame ptr (int): 2
      Arg stack: [({Push Code {..}, Enter Arg 1},FrameAddr 3)
                  ({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 4]
      
  31) Code:  {Push Code {..}, Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 4]
      
  32) Code:  {Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Op Add, Return},FrameAddr 3)
                  ({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 4]
      
  33) Code:  {PushV FramePtr, Return}
      Frame ptr (int): 2
      Arg stack: [({Op Add, Return},FrameAddr 3)
                  ({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 4]
      
  34) Code:  {Return}
      Frame ptr (int): 2
      Arg stack: [({Op Add, Return},FrameAddr 3)
                  ({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 2, 4]
      
  35) Code:  {Op Add, Return}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 2, 4]
      
  36) Code:  {Return}
      Frame: <({PushV FramePtr, Return},FrameInt 2)
              ({PushV FramePtr, Return},FrameInt 2)>
      Arg stack: [({Op Mul, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[4, 4]
      
  37) Code:  {Op Mul, Return}
      Frame: <({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)
              ({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)>
      Arg stack: [({},FrameNull)]
      VStack:[4, 4]
      
  38) Code:  {Return}
      Frame: <({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)
              ({Push IntConst 2, Push IntConst 2, Enter Label "+"},FrameNull)>
      Arg stack: [({},FrameNull)]
      VStack:[16]
      
  39) Code:  {}
      Null frame ptr
      Arg stack: []
      VStack:[16]
      


Steps taken = 39
Frames allocated =  3
Total heap allocations = 6
