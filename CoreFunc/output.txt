Supercombinator definitions
Code for I:
   {Take (1,1),
    Enter Arg 1}


Code for K:
   {Take (2,2),
    Enter Arg 1}


Code for K1:
   {Take (2,2),
    Enter Arg 2}


Code for S:
   {Take (3,3),
    Push Code {Push Arg 3,
               Enter Arg 2},
    Push Arg 3,
    Enter Arg 1}


Code for compose:
   {Take (3,3),
    Push Code {Push Arg 3,
               Enter Arg 2},
    Enter Arg 1}


Code for twice:
   {Take (1,1),
    Push Arg 1,
    Push Arg 1,
    Enter Label "compose"}


Code for f:
   {Take (3,1),
    Move
      (2,
       Code
         [PushV (IntVConst 1);
          Push
            (Code
               [Op Lt;
                Cond
                  ([PushV (IntVConst 1); Return],
                   [Push (Code [Return]); Enter (Arg 3)])]); Enter (Arg 1)]),
    Move
      (3,
       Code
         [PushV (IntVConst 1);
          Push
            (Code
               [Op Lt;
                Cond
                  ([Push (Code [Return]); Enter (Arg 2)],
                   [PushV (IntVConst 2); Return])]); Enter (Arg 1)]),
    Push Code {Push Code {Op Add,
                          Return},
               Enter Arg 2},
    Enter Arg 3}


Code for main:
   {Push IntConst 1,
    Enter Label "f"}



State transitions

   0) Code:  {Enter Label "main"}
      Null frame ptr
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   1) Code:  {Push IntConst 1, Enter Label "f"}
      Null frame ptr
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   2) Code:  {Enter Label "f"}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 1)
                  ({},FrameNull)]
      VStack:[]
      
   3) Code:  {Take (3,1), Move
                (2,
                 Code
                   [PushV (IntVConst 1);
                    Push
                      (Code
                         [Op Lt;
                          Cond
                            ([PushV (IntVConst 1); Return],
                             [Push (Code [Return]); Enter (Arg 3)])]); Enter (Arg 1)]), Move
                (3,
                 Code
                   [PushV (IntVConst 1);
                    Push
                      (Code
                         [Op Lt;
                          Cond
                            ([Push (Code [Return]); Enter (Arg 2)],
                             [PushV (IntVConst 2); Return])]); Enter (Arg 1)]), ..}
      Null frame ptr
      Arg stack: [({PushV FramePtr, Return},FrameInt 1)
                  ({},FrameNull)]
      VStack:[]
      
   4) Code:  {Move
                (2,
                 Code
                   [PushV (IntVConst 1);
                    Push
                      (Code
                         [Op Lt;
                          Cond
                            ([PushV (IntVConst 1); Return],
                             [Push (Code [Return]); Enter (Arg 3)])]); Enter (Arg 1)]), Move
                (3,
                 Code
                   [PushV (IntVConst 1);
                    Push
                      (Code
                         [Op Lt;
                          Cond
                            ([Push (Code [Return]); Enter (Arg 2)],
                             [PushV (IntVConst 2); Return])]); Enter (Arg 1)]), Push Code {..}, ..}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({},FrameNull)
              ({},FrameNull)>
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   5) Code:  {Move
                (3,
                 Code
                   [PushV (IntVConst 1);
                    Push
                      (Code
                         [Op Lt;
                          Cond
                            ([Push (Code [Return]); Enter (Arg 2)],
                             [PushV (IntVConst 2); Return])]); Enter (Arg 1)]), Push Code {..}, Enter Arg 3}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({},FrameNull)>
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   6) Code:  {Push Code {..}, Enter Arg 3}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({},FrameNull)]
      VStack:[]
      
   7) Code:  {Enter Arg 3}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
   8) Code:  {PushV (IntVConst 1), Push Code {..}, Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
   9) Code:  {Push Code {..}, Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1]
      
  10) Code:  {Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Op Lt, Cond},FrameAddr 1)
                  ({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1]
      
  11) Code:  {PushV FramePtr, Return}
      Frame ptr (int): 1
      Arg stack: [({Op Lt, Cond},FrameAddr 1)
                  ({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1]
      
  12) Code:  {Return}
      Frame ptr (int): 1
      Arg stack: [({Op Lt, Cond},FrameAddr 1)
                  ({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 1]
      
  13) Code:  {Op Lt, Cond}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 1]
      
  14) Code:  {Cond}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1]
      
  15) Code:  {PushV (IntVConst 2), Return}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[]
      
  16) Code:  {Return}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Push Code {..}, Enter Arg 2},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  17) Code:  {Push Code {..}, Enter Arg 2}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({},FrameNull)]
      VStack:[2]
      
  18) Code:  {Enter Arg 2}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  19) Code:  {PushV (IntVConst 1), Push Code {..}, Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  20) Code:  {Push Code {..}, Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2]
      
  21) Code:  {Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Op Lt, Cond},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2]
      
  22) Code:  {PushV FramePtr, Return}
      Frame ptr (int): 1
      Arg stack: [({Op Lt, Cond},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2]
      
  23) Code:  {Return}
      Frame ptr (int): 1
      Arg stack: [({Op Lt, Cond},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 1, 2]
      
  24) Code:  {Op Lt, Cond}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 1, 2]
      
  25) Code:  {Cond}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2]
      
  26) Code:  {Push Code {..}, Enter Arg 3}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  27) Code:  {Enter Arg 3}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Return},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  28) Code:  {PushV (IntVConst 1), Push Code {..}, Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Return},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  29) Code:  {Push Code {..}, Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Return},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2]
      
  30) Code:  {Enter Arg 1}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Op Lt, Cond},FrameAddr 1)
                  ({Return},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2]
      
  31) Code:  {PushV FramePtr, Return}
      Frame ptr (int): 1
      Arg stack: [({Op Lt, Cond},FrameAddr 1)
                  ({Return},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2]
      
  32) Code:  {Return}
      Frame ptr (int): 1
      Arg stack: [({Op Lt, Cond},FrameAddr 1)
                  ({Return},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 1, 2]
      
  33) Code:  {Op Lt, Cond}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Return},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 1, 2]
      
  34) Code:  {Cond}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Return},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[1, 2]
      
  35) Code:  {PushV (IntVConst 2), Return}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Return},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2]
      
  36) Code:  {Return}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Return},FrameAddr 1)
                  ({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 2]
      
  37) Code:  {Return}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({Op Add, Return},FrameAddr 1)
                  ({},FrameNull)]
      VStack:[2, 2]
      
  38) Code:  {Op Add, Return}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({},FrameNull)]
      VStack:[2, 2]
      
  39) Code:  {Return}
      Frame: <({PushV FramePtr, Return},FrameInt 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)
              ({PushV (IntVConst 1), Push Code {..}, Enter Arg 1},FrameAddr 1)>
      Arg stack: [({},FrameNull)]
      VStack:[4]
      
  40) Code:  {}
      Null frame ptr
      Arg stack: []
      VStack:[4]
      


Steps taken = 40
Frames allocated =  1
Total heap allocations = 1
